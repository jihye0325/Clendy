<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.clendy.admin.model.dao.StoreMapper">

	<resultMap id="ApplyResultMap" type="com.kh.clendy.joinStore.model.vo.ApplyStore">
		<id property="a_no" column="A_NO"/>
		<result property="seller_name" column="SELLER_NAME"/>
		<result property="rep_name" column="REP_NAME"/>
		<result property="rep_num" column="REP_NUM"/>
		<result property="b_license" column="B_LICENSE"/>
		<result property="o_b_license" column="O_B_LICENSE"/>
		<result property="phone" column="PHONE"/>
		<result property="email" column="EMAIL"/>
		<result property="address" column="ADDRESS"/>
		<result property="account_bank" column="ACCOUNT_BANK"/>
		<result property="account_num" column="ACCOUNT_NUM"/>
		<result property="apply_date" column="APPLY_DATE"/>
		<result property="user_no" column="USER_NO"/>
	</resultMap>
	
	<resultMap id="CancelResultMap" type="com.kh.clendy.admin.model.vo.CancelStore">
		<id property="can_no" column="CAN_NO"/>
		<result property="c_date" column="C_DATE"/>
		<result property="complete_date" column="COMPLETE_DATE"/>
		<result property="seller_code" column="SELLER_CODE"/>
		<result property="a_no" column="A_NO"/>
		<result property="seller_name" column="SELLER_NAME"/>
		<result property="rep_name" column="REP_NAME"/>
		<result property="b_license" column="B_LICENSE"/>
	</resultMap>
	
	<!-- 입점신청리스트 개수 조회 -->
	<select id="joinStoreGetListCount" resultType="_int">
		SELECT
				COUNT(*)
 	      FROM (SELECT 
                       A_NO
                  FROM APPLY_STORE
                MINUS
                SELECT A_NO
                  FROM SELLER)
	</select>
	
	<!-- 입청 신청 리스트 조회 -->
	<select id="selectAllJoinStoreList" parameterType="HashMap" resultMap="ApplyResultMap">
	SELECT
            *
            FROM(
            SELECT
       ROWNUM ROWN
     , TBL.*    
    FROM( SELECT	
            A_NO
		  , SELLER_NAME
		  , REP_NAME
		  , REP_NUM
		  , B_LICENSE
		  , O_B_LICENSE
		  , PHONE
		  , EMAIL
		  , ADDRESS
		  , ACCOUNT_BANK
		  , ACCOUNT_NUM
		  , APPLY_DATE
		  , USER_NO
       FROM APPLY_STORE 
      WHERE A_NO IN (SELECT 
                            A_NO
                       FROM APPLY_STORE
                     MINUS
                     SELECT A_NO
                       FROM SELLER)
      ORDER BY A_NO) TBL)
          WHERE ROWN BETWEEN #{startRow} AND #{endRow}
	</select>
	
	<!-- 입점 취소 신청 전체 개수 -->
	<select id="cancelStoreGetListCount" resultType="_int">
	SELECT
		   COUNT(*)
	  FROM CANCEL_STORE	
	 WHERE COMPLETE_DATE IS NULL
	</select>
	
	<!-- 입점 취소 신청 리스트 조회 -->
	<select id="selectAllCancelStoreList" parameterType="HashMap" resultMap="CancelResultMap">
	SELECT
            *
            FROM(
            SELECT
       ROWNUM ROWN
     , TBL.*    
    FROM( SELECT
		   CAN_NO
		 , C_DATE
		 , COMPLETE_DATE
		 , SELLER_CODE
		 , A_NO
		 , A.SELLER_NAME
		 , REP_NAME
		 , B_LICENSE
      FROM CANCEL_STORE C
      JOIN SELLER S	USING(SELLER_CODE)
      JOIN APPLY_STORE A USING(A_NO)
     WHERE COMPLETE_DATE IS NULL
     ORDER BY C_DATE) TBL)
          WHERE ROWN BETWEEN #{startRow} AND #{endRow}  
	</select>
</mapper>















